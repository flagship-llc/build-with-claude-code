# チュートリアル: Excelデータ活用ツールを作ろう

このチュートリアルでは、自分が持っているExcelやGoogle Sheetsのデータを読み込んで、分析・可視化・レポート生成を行うツールを作ります。

---

## 完成イメージ

```
【売上データ分析レポート】
期間: 2024年1月〜3月

【月別売上】
1月: ¥1,234,567 (前月比 +5.2%)
2月: ¥1,345,678 (前月比 +9.0%)
3月: ¥1,456,789 (前月比 +8.3%)

【商品別ランキング】
1位: 商品A - ¥567,890
2位: 商品B - ¥456,789
3位: 商品C - ¥345,678

【グラフ】
[売上推移のグラフが表示される]
```

---

## 所要時間

1〜2時間

---

## 事前準備

1. 環境構築が完了していること
2. 分析したいExcelファイル または Google Sheetsへのアクセス

### サンプルデータがない場合

チュートリアル内でサンプルデータを作成するので、手元にデータがなくても大丈夫です。

---

## Step 1: プロジェクトを作成

### VS Codeでフォルダを開く

1. VS Codeを起動
2. 「ファイル」→「フォルダーを開く」
3. `~/projects/excel-analyzer` というフォルダを新規作成して開く

### Claude Codeを開く

左サイドバーの **Claudeアイコン** をクリックしてチャットパネルを開きます。

---

## Step 2: サンプルデータを作成

まずは練習用のサンプルデータを作ります。

### Claudeに伝える

```
売上データのサンプルExcelファイルを作って。

ファイル名: sales_data.xlsx

カラム:
- 日付
- 商品名
- カテゴリ
- 数量
- 単価
- 売上金額
- 担当者
- 地域

データ:
- 2024年1月〜3月の3ヶ月分
- 約100行くらいのリアルなデータ
- 商品は5種類くらい
- 担当者は3人くらい
- 地域は関東、関西、中部

openpyxlを使って作成して。
```

### 確認

```
sales_data.xlsx が作成されたか確認して。最初の10行を表示して。
```

---

## Step 3: データを読み込んで表示

Excelファイルを読み込む基本的なスクリプトを作ります。

### Claudeに伝える

```
sales_data.xlsx を読み込んで表示するPythonスクリプトを作って。

ファイル名: analyzer.py

機能:
- pandasでExcelファイルを読み込む
- データの基本情報を表示（行数、カラム一覧）
- 最初の10行を表示

使い方: python analyzer.py sales_data.xlsx
```

---

## Step 4: 基本的な分析機能を追加

データの集計・分析機能を追加します。

### Claudeに伝える

```
analyzer.py に分析機能を追加して。

追加する機能:
1. 月別の売上合計
2. 商品別の売上ランキング（トップ5）
3. 担当者別の売上
4. 地域別の売上

結果は見やすくフォーマットして表示。
```

---

## Step 5: グラフで可視化

分析結果をグラフで可視化します。

### Claudeに伝える

```
analyzer.py にグラフ表示機能を追加して。

作成するグラフ:
1. 月別売上の棒グラフ
2. 商品別売上の円グラフ
3. 日別売上の折れ線グラフ

matplotlibを使用。
日本語が表示できるようにして。
グラフはPNG画像として保存。
```

---

## Step 6: レポートを自動生成

分析結果をレポートファイルとして出力します。

### Claudeに伝える

```
分析結果をMarkdownレポートとして出力する機能を追加して。

レポートの内容:
- タイトル（データファイル名と日付）
- サマリー（総売上、件数、期間）
- 月別売上
- 商品別ランキング
- 担当者別分析
- 地域別分析
- グラフ画像の埋め込み

ファイル名: report_YYYYMMDD.md
```

---

## Google Sheetsを使う場合

ExcelではなくGoogle Sheetsを使いたい場合の手順です。

### Claudeに伝える

```
Google Sheetsからデータを読み込むように変更して。

機能:
- Google Sheets APIを使用
- スプレッドシートIDを引数で指定
- シート名を指定可能（デフォルトは最初のシート）

認証にはサービスアカウントを使用。
```

### Google Sheets APIの設定

1. [Google Cloud Console](https://console.cloud.google.com/) にアクセス
2. 「APIとサービス」→「ライブラリ」で「Google Sheets API」を有効化
3. 「認証情報」→「サービスアカウント」を作成
4. サービスアカウントのキー（JSON）をダウンロード
5. Google Sheetsで対象のシートをサービスアカウントのメールアドレスと共有

---

## 自分のデータで試す

チュートリアルが動いたら、自分の業務データで試してみましょう。

### データを用意する

- 売上データ
- 顧客リスト
- 在庫データ
- 勤怠データ
- 経費データ

など、分析したいExcelファイルを `excel-analyzer` フォルダにコピーします。

### 分析内容をカスタマイズ

```
@自分のファイル.xlsx このファイルを分析して。
カラム構造を確認して、分析できる項目を提案して。
```

Claudeが自動的にデータ構造を解析し、適切な分析を提案してくれます。

---

## 発展課題（余裕があれば）

### WebUIを付ける

```
このツールにWebインターフェースを付けて。
- ファイルをアップロード
- 分析ボタンをクリック
- 結果とグラフを表示
FlaskまたはStreamlitで。
```

### 定期レポート自動生成

```
毎週月曜日に先週の売上レポートを自動生成して、
Slackに投稿する機能を追加して。
```

### 複数ファイルの比較

```
2つのExcelファイルを比較して、差分を表示する機能を追加して。
例: 先月と今月の売上を比較
```

### PDF出力

```
レポートをPDF形式でも出力できるようにして
```

---

## トラブルシューティング

### 「openpyxlがインストールされていません」

```
openpyxlをインストールして
```

### 日本語が文字化けする

```
Excelファイルの文字コードを確認して。
読み込み時にUTF-8を指定して。
```

### グラフの日本語が□になる

```
matplotlibで日本語フォントを設定して。
Macならヒラギノ角ゴシック、Windowsならメイリオを使って。
```

### Google Sheets認証エラー

```
サービスアカウントの認証情報ファイルのパスを確認して。
シートがサービスアカウントと共有されているか確認して。
```

---

## チェックリスト

- [ ] VS CodeでClaude Codeのチャットパネルを開けた
- [ ] サンプルデータ（sales_data.xlsx）を作成した
- [ ] analyzer.py でデータを読み込めた
- [ ] 基本的な分析（月別、商品別など）ができた
- [ ] グラフを生成できた
- [ ] レポートを出力できた
- [ ] （オプション）自分のデータで分析できた

---

## 次のステップ

- [朝の通知ツール](./tutorial-morning) - API連携を試す
- [サンプルテンプレート集](./templates) - 他のアイデアを探す

このチュートリアルで学んだデータ処理の知識を活かして、業務効率化ツールを作ってみましょう！
